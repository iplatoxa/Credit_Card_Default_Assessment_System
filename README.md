# Система оценки кредитного риска с веб-интерфейсом

![Python](https://img.shields.io/badge/Python-Scikit--learn-blue)
![Gradio](https://img.shields.io/badge/Interface-Gradio-green)
![Status](https://img.shields.io/badge/Status-Completed-success)

## Ссылки на проект

**ВАЖНО**: проект реализован в Google Colab с веб-интерфейсом на Gradio. Для просмотра и тестирования откройте ноутбук в Colab:

[![Open in Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1SinSqqGEeeUP6cW3G--IyzzHiH-SAMZR#scrollTo=o4Ke-tqDY4H9)


## Описание проекта
Данный проект представляет собой комплексную систему машинного обучения для прогнозирования дефолта по кредитным картам. Проект включает полный цикл: от анализа данных до развертывания веб-интерфейса для взаимодействия с моделью.

### Ключевые вопросы:
- Какие факторы наиболее сильно влияют на вероятность дефолта по кредитной карте?
- Как история платежей клиента связана с будущими рисками?
- Какие клиенты представляют наибольшую опасность для банка?
- Как автоматизировать процесс оценки кредитных рисков?

## Исходные данные

Датасет Default of Credit Card Clients Dataset содержит информацию о 30,000 клиентах Тайваньского банка:

| Поле | Описание |
|------|-----------|
| LIMIT_BAL | Кредитный лимит (NT dollar) |
| SEX | Пол (1=мужской, 2=женский) |
| EDUCATION | Образование |
| MARRIAGE | Семейное положение |
| AGE | Возраст в годах |
| PAY_0-PAY_6 | История платежей за последние 6 месяцев |
| BILL_AMT1-BILL_AMT6 | Суммы счетов за последние 6 месяцев |
| PAY_AMT1-PAY_AMT6 | Суммы платежей за последние 6 месяцев |
| default | Целевая переменная: Дефолт в следующем месяце |

## Технологии и библиотеки

- **Python 3**
- **Анализ данных**: Pandas, NumPy
- **Визуализация**: Matplotlib, Seaborn
- **Статистика**: SciPy
- **Машинное обучение**: Scikit-learn
- **Веб-интерфейс**: Gradio
- **Сериализация**: Joblib

## Основные этапы анализа

### 1. Предобработка данных
- Очистка и проверка на пропуски
- Объединение редких категорий
- Создание производных признаков на основе истории платежей

### 2. Разведочный анализ (EDA)
- Анализ распределения демографических признаков
- Исследование платежного поведения клиентов
- Выявление паттернов, связанных с дефолтом

### 3. Создание производных признаков
- `recent_delay_flag` - флаг задержки в последнем месяце
- `max_delay_6m` - максимальная задержка за 6 месяцев
- `total_delays_count` - количество месяцев с задержками
- `is_always_ontime` - всегда ли платил вовремя
- `uses_installment_often` - частое использование рассрочки
- `payment_deterioration` - ухудшение платежной дисциплины

### 4. Машинное обучение
- Подготовка данных (масштабирование, кодирование)
- Обучение и сравнение нескольких моделей
- Оптимизация гиперпараметров
- Создание веб-интерфейса для взаимодействия

## Ключевые выводы

### Результаты анализа данных

**Демографические особенности:**
- Преобладают женщины (60.4%) с высшим образованием (82.1%)
- Основная возрастная группа: 25-45 лет
- Большинство клиентов не состоят в браке (53.2%)

**Платежное поведение:**
- 50% клиентов регулярно используют рассрочку
- Задержка платежа даже на 1 месяц увеличивает риск дефолта в 3.6 раза
- Клиенты с максимальной задержкой 3+ месяцев имеют 60-80% вероятность дефолта

**Финансовые показатели:**
- Обратная зависимость: чем выше кредитный лимит, тем ниже риск дефолта
- Прямая зависимость: чем выше использование лимита, тем выше риск
- Возраст слабо коррелирует с риском дефолта

### Результаты моделирования

Лучшие результаты показала модель **Gradient Boosting**:

- **Accuracy**: 81.2%
- **AUC**: 76.9%
- **CV AUC**: 78.0%

**Ключевые предикторы в модели:**
1. `recent_delay_flag` (корреляция 0.37) - задержка в последнем месяце
2. `max_delay_6m` (корреляция 0.33) - максимальная задержка
3. `LIMIT_BAL` (корреляция -0.15) - кредитный лимит

## Веб-интерфейс

Проект включает интерактивный веб-интерфейс, созданный с помощью Gradio, который позволяет:

- Вводить данные клиента через удобные формы
- Получать мгновенную оценку вероятности дефолта
- Видеть цветовую индикацию риска (зеленый/оранжевый/красный)
- Получать рекомендации по действию (одобрить/проверить/отклонить)
- Тестировать на готовых примерах

## Бизнес-применение

### Практическая ценность:
- **Снижение рисков**: Выявление 75% потенциальных дефолтов
- **Автоматизация**: Ускорение процесса кредитного скоринга
- **Объективность**: Устранение человеческого фактора в оценке рисков
- **Масштабируемость**: Возможность обработки тысяч заявок ежедневно

### Рекомендации для банка:
1. **Фокус на истории платежей** - самый сильный предиктор риска
2. **Мониторинг использования лимита** - клиенты с использованием >80% лимита требуют внимания
3. **Гибкая стратегия** - разные пороги риска для разных продуктов
4. **Раннее выявление** - задержки платежей как ранний сигнал проблем

## Быстрый старт

### Запуск в Google Colab:
1. Откройте ноутбук в Google Colab
2. Выполните все ячейки по порядку
3. После выполнения блока с Gradio интерфейсом откроется веб-приложение
4. Используйте готовые примеры или введите свои данные для тестирования


Особенности реализации

· Интерпретируемость: Модель предоставляет понятные вероятности и рекомендации
· Производительность: Оптимизирована для быстрого предсказания
· Масштабируемость: Готова к интеграции в производственные системы
· Пользовательский опыт: Интуитивный интерфейс с подсказками и примерами

Разработано в рамках подготовки к стажировке в банк на позицию аналитика данных
